(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const l of u)if(l.type==="childList")for(const L of l.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&c(L)}).observe(document,{childList:!0,subtree:!0});function w(u){const l={};return u.integrity&&(l.integrity=u.integrity),u.referrerPolicy&&(l.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?l.credentials="include":u.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(u){if(u.ep)return;u.ep=!0;const l=w(u);fetch(u.href,l)}})();const le=document.getElementById("app");function oe(n,d={},w=[]){const c=document.createElement(n);return Object.entries(d).forEach(([u,l])=>c.setAttribute(u,l)),w.forEach(u=>c.appendChild(typeof u=="string"?document.createTextNode(u):u)),c}function $e(n){return n.type==="text"?oe("h2",{},[n.text]):n.type==="image"?oe("img",{src:n.src,width:"200"}):oe("p",{},["Unsupported prompt"])}function je(n,d){const w=oe("button",{class:"choice","data-id":n.id});return n.type==="text"?w.textContent=n.text:(w.classList.add("img-choice"),w.appendChild(oe("img",{src:n.src,width:"120"}))),w.onclick=d,w}function qe(n,d,w){if(le.innerHTML="",d){const l=(d.correct/d.asked*100).toFixed(0);le.appendChild(oe("p",{class:"stat"},[`正答 ${d.correct}/${d.asked} (${l}%)`]))}else le.appendChild(oe("p",{class:"stat"},["正答 0/0 (0%)"]));le.appendChild($e(n.prompt));const c=oe("div",{class:"choices"});[...n.choices].sort(()=>Math.random()-.5).forEach(l=>c.appendChild(je(l,()=>{const L=l.id===n.answer;w(L,l.id)}))),le.appendChild(c)}const Ae="memorizer-history-v1";function ze(){try{return JSON.parse(localStorage.getItem(Ae)||"[]")}catch{return[]}}function Be(n){localStorage.setItem(Ae,JSON.stringify(n))}function Ue(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var pe={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var He=pe.exports,Ie;function Ne(){return Ie||(Ie=1,function(n,d){((w,c)=>{n.exports=c()})(He,function w(){var c=typeof self<"u"?self:typeof window<"u"?window:c!==void 0?c:{},u,l=!c.document&&!!c.postMessage,L=c.IS_PAPA_WORKER||!1,M={},W=0,o={};function D(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var r=ve(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new Z(r),(this._handle.streamer=this)._config=r}).call(this,e),this.parseChunk=function(t,r){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let p=this._config.newline;p||(i=this._config.quoteChar||'"',p=this._handle.guessLineEndings(t,i)),t=[...t.split(p).slice(s)].join(p)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t,i=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,s=(this._finished||(this._partialLine=s.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),L)c.postMessage({results:i,workerId:o.WORKER_ID,finished:s});else if(S(this._config.chunk)&&!r){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!S(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){S(this._config.error)?this._config.error(t):L&&this._config.error&&c.postMessage({workerId:o.WORKER_ID,error:t,finished:!1})}}function ne(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),D.call(this,e),this._nextChunk=l?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),l||(t.onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!l),this._config.downloadRequestHeaders){var r,s=this._config.downloadRequestHeaders;for(r in s)t.setRequestHeader(r,s[r])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(p){this._chunkError(p.message)}l&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function b(e){(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),D.call(this,e);var t,r,s=typeof FileReader<"u";this.stream=function(i){this._input=i,r=i.slice||i.webkitSlice||i.mozSlice,s?((t=new FileReader).onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,p=(this._config.chunkSize&&(p=Math.min(this._start+this._config.chunkSize,this._input.size),i=r.call(i,this._start,p)),t.readAsText(i,this._config.encoding));s||this._chunkLoaded({target:{result:p}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function E(e){var t;D.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,s;if(!this._finished)return r=this._config.chunkSize,t=r?(s=t.substring(0,r),t.substring(r)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function F(e){D.call(this,e=e||{});var t=[],r=!0,s=!1;this.pause=function(){D.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){D.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=se(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(p){this._streamError(p)}},this),this._streamError=se(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=se(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Z(e){var t,r,s,i,p=Math.pow(2,53),K=-p,G=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,X=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,_=this,I=0,h=0,U=!1,f=!1,y=[],a={data:[],errors:[],meta:{}};function $(k){return e.skipEmptyLines==="greedy"?k.join("").trim()==="":k.length===1&&k[0].length===0}function P(){if(a&&s&&(V("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(a.data=a.data.filter(function(R){return!$(R)})),B()){let R=function(q,O){S(e.transformHeader)&&(q=e.transformHeader(q,O)),y.push(q)};var m=R;if(a)if(Array.isArray(a.data[0])){for(var k=0;B()&&k<a.data.length;k++)a.data[k].forEach(R);a.data.splice(0,1)}else a.data.forEach(R)}function v(R,q){for(var O=e.header?{}:[],x=0;x<R.length;x++){var g=x,H=R[x],H=((C,T)=>(j=>(e.dynamicTypingFunction&&e.dynamicTyping[j]===void 0&&(e.dynamicTyping[j]=e.dynamicTypingFunction(j)),(e.dynamicTyping[j]||e.dynamicTyping)===!0))(C)?T==="true"||T==="TRUE"||T!=="false"&&T!=="FALSE"&&((j=>{if(G.test(j)&&(j=parseFloat(j),K<j&&j<p))return 1})(T)?parseFloat(T):X.test(T)?new Date(T):T===""?null:T):T)(g=e.header?x>=y.length?"__parsed_extra":y[x]:g,H=e.transform?e.transform(H,g):H);g==="__parsed_extra"?(O[g]=O[g]||[],O[g].push(H)):O[g]=H}return e.header&&(x>y.length?V("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+x,h+q):x<y.length&&V("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+x,h+q)),O}var A;a&&(e.header||e.dynamicTyping||e.transform)&&(A=1,!a.data.length||Array.isArray(a.data[0])?(a.data=a.data.map(v),A=a.data.length):a.data=v(a.data,0),e.header&&a.meta&&(a.meta.fields=y),h+=A)}function B(){return e.header&&y.length===0}function V(k,v,A,m){k={type:k,code:v,message:A},m!==void 0&&(k.row=m),a.errors.push(k)}S(e.step)&&(i=e.step,e.step=function(k){a=k,B()?P():(P(),a.data.length!==0&&(I+=k.data.length,e.preview&&I>e.preview?r.abort():(a.data=a.data[0],i(a,_))))}),this.parse=function(k,v,A){var m=e.quoteChar||'"',m=(e.newline||(e.newline=this.guessLineEndings(k,m)),s=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(k),a.meta.delimiter=e.delimiter):((m=((R,q,O,x,g)=>{var H,C,T,j;g=g||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var ce=0;ce<g.length;ce++){for(var ee,he=g[ce],N=0,te=0,z=0,Q=(T=void 0,new Y({comments:x,delimiter:he,newline:q,preview:10}).parse(R)),ie=0;ie<Q.data.length;ie++)O&&$(Q.data[ie])?z++:(ee=Q.data[ie].length,te+=ee,T===void 0?T=ee:0<ee&&(N+=Math.abs(ee-T),T=ee));0<Q.data.length&&(te/=Q.data.length-z),(C===void 0||N<=C)&&(j===void 0||j<te)&&1.99<te&&(C=N,H=he,j=te)}return{successful:!!(e.delimiter=H),bestDelimiter:H}})(k,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=m.bestDelimiter:(s=!0,e.delimiter=o.DefaultDelimiter),a.meta.delimiter=e.delimiter),ve(e));return e.preview&&e.header&&m.preview++,t=k,r=new Y(m),a=r.parse(t,v,A),P(),U?{meta:{paused:!0}}:a||{meta:{paused:!1}}},this.paused=function(){return U},this.pause=function(){U=!0,r.abort(),t=S(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){_.streamer._halted?(U=!1,_.streamer.parseChunk(t,!0)):setTimeout(_.resume,3)},this.aborted=function(){return f},this.abort=function(){f=!0,r.abort(),a.meta.aborted=!0,S(e.complete)&&e.complete(a),t=""},this.guessLineEndings=function(R,m){R=R.substring(0,1048576);var m=new RegExp(J(m)+"([^]*?)"+J(m),"gm"),A=(R=R.replace(m,"")).split("\r"),m=R.split(`
`),R=1<m.length&&m[0].length<A[0].length;if(A.length===1||R)return`
`;for(var q=0,O=0;O<A.length;O++)A[O][0]===`
`&&q++;return q>=A.length/2?`\r
`:"\r"}}function J(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Y(e){var t=(e=e||{}).delimiter,r=e.newline,s=e.comments,i=e.step,p=e.preview,K=e.fastMode,G=null,X=!1,_=e.quoteChar==null?'"':e.quoteChar,I=_;if(e.escapeChar!==void 0&&(I=e.escapeChar),(typeof t!="string"||-1<o.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");s===!0?s="#":(typeof s!="string"||-1<o.BAD_DELIMITERS.indexOf(s))&&(s=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var h=0,U=!1;this.parse=function(f,y,a){if(typeof f!="string")throw new Error("Input must be a string");var $=f.length,P=t.length,B=r.length,V=s.length,k=S(i),v=[],A=[],m=[],R=h=0;if(!f)return N();if(K||K!==!1&&f.indexOf(_)===-1){for(var q=f.split(r),O=0;O<q.length;O++){if(m=q[O],h+=m.length,O!==q.length-1)h+=r.length;else if(a)return N();if(!s||m.substring(0,V)!==s){if(k){if(v=[],j(m.split(t)),te(),U)return N()}else j(m.split(t));if(p&&p<=O)return v=v.slice(0,p),N(!0)}}return N()}for(var x=f.indexOf(t,h),g=f.indexOf(r,h),H=new RegExp(J(I)+J(_),"g"),C=f.indexOf(_,h);;)if(f[h]===_)for(C=h,h++;;){if((C=f.indexOf(_,C+1))===-1)return a||A.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:h}),ee();if(C===$-1)return ee(f.substring(h,C).replace(H,_));if(_===I&&f[C+1]===I)C++;else if(_===I||C===0||f[C-1]!==I){x!==-1&&x<C+1&&(x=f.indexOf(t,C+1));var T=ce((g=g!==-1&&g<C+1?f.indexOf(r,C+1):g)===-1?x:Math.min(x,g));if(f.substr(C+1+T,P)===t){m.push(f.substring(h,C).replace(H,_)),f[h=C+1+T+P]!==_&&(C=f.indexOf(_,h)),x=f.indexOf(t,h),g=f.indexOf(r,h);break}if(T=ce(g),f.substring(C+1+T,C+1+T+B)===r){if(m.push(f.substring(h,C).replace(H,_)),he(C+1+T+B),x=f.indexOf(t,h),C=f.indexOf(_,h),k&&(te(),U))return N();if(p&&v.length>=p)return N(!0);break}A.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:h}),C++}}else if(s&&m.length===0&&f.substring(h,h+V)===s){if(g===-1)return N();h=g+B,g=f.indexOf(r,h),x=f.indexOf(t,h)}else if(x!==-1&&(x<g||g===-1))m.push(f.substring(h,x)),h=x+P,x=f.indexOf(t,h);else{if(g===-1)break;if(m.push(f.substring(h,g)),he(g+B),k&&(te(),U))return N();if(p&&v.length>=p)return N(!0)}return ee();function j(z){v.push(z),R=h}function ce(z){var Q=0;return Q=z!==-1&&(z=f.substring(C+1,z))&&z.trim()===""?z.length:Q}function ee(z){return a||(z===void 0&&(z=f.substring(h)),m.push(z),h=$,j(m),k&&te()),N()}function he(z){h=z,j(m),m=[],g=f.indexOf(r,h)}function N(z){if(e.header&&!y&&v.length&&!X){var Q=v[0],ie={},Ee=new Set(Q);let Te=!1;for(let de=0;de<Q.length;de++){let re=Q[de];if(ie[re=S(e.transformHeader)?e.transformHeader(re,de):re]){let ue,Le=ie[re];for(;ue=re+"_"+Le,Le++,Ee.has(ue););Ee.add(ue),Q[de]=ue,ie[re]++,Te=!0,(G=G===null?{}:G)[ue]=re}else ie[re]=1,Q[de]=re;Ee.add(re)}Te&&console.warn("Duplicate headers found and renamed."),X=!0}return{data:v,errors:A,meta:{delimiter:t,linebreak:r,aborted:U,truncated:!!z,cursor:R+(y||0),renamedHeaders:G}}}function te(){i(N()),v=[],A=[]}},this.abort=function(){U=!0},this.getCharIndex=function(){return h}}function we(e){var t=e.data,r=M[t.workerId],s=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){s=!0,Re(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Oe,resume:Oe};if(S(r.userStep)){for(var p=0;p<t.results.data.length&&(r.userStep({data:t.results.data[p],errors:t.results.errors,meta:t.results.meta},i),!s);p++);delete t.results}else S(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!s&&Re(t.workerId,t.results)}function Re(e,t){var r=M[e];S(r.userComplete)&&r.userComplete(t),r.terminate(),delete M[e]}function Oe(){throw new Error("Not implemented.")}function ve(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ve(e[t]);return r}function se(e,t){return function(){e.apply(t,arguments)}}function S(e){return typeof e=="function"}return o.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(S(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!S(t.transform)&&t.transform,!t.worker||!o.WORKERS_SUPPORTED)return r=null,o.NODE_STREAM_INPUT,typeof e=="string"?(e=(s=>s.charCodeAt(0)!==65279?s:s.slice(1))(e),r=new(t.download?ne:E)(t)):e.readable===!0&&S(e.read)&&S(e.on)?r=new F(t):(c.File&&e instanceof File||e instanceof Object)&&(r=new b(t)),r.stream(e);(r=(()=>{var s;return!!o.WORKERS_SUPPORTED&&(s=(()=>{var i=c.URL||c.webkitURL||null,p=w.toString();return o.BLOB_URL||(o.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",p,")();"],{type:"text/javascript"})))})(),(s=new c.Worker(s)).onmessage=we,s.id=W++,M[s.id]=s)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=S(t.step),t.chunk=S(t.chunk),t.complete=S(t.complete),t.error=S(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},o.unparse=function(e,t){var r=!1,s=!0,i=",",p=`\r
`,K='"',G=K+K,X=!1,_=null,I=!1,h=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||o.BAD_DELIMITERS.filter(function(y){return t.delimiter.indexOf(y)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(X=t.skipEmptyLines),typeof t.newline=="string"&&(p=t.newline),typeof t.quoteChar=="string"&&(K=t.quoteChar),typeof t.header=="boolean"&&(s=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}t.escapeChar!==void 0&&(G=t.escapeChar+K),t.escapeFormulae instanceof RegExp?I=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(I=/^[=+\-@\t\r].*$/)}})(),new RegExp(J(K),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return U(null,e,X);if(typeof e[0]=="object")return U(_||Object.keys(e[0]),e,X)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||_),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),U(e.fields||[],e.data||[],X);throw new Error("Unable to serialize unrecognized input");function U(y,a,$){var P="",B=(typeof y=="string"&&(y=JSON.parse(y)),typeof a=="string"&&(a=JSON.parse(a)),Array.isArray(y)&&0<y.length),V=!Array.isArray(a[0]);if(B&&s){for(var k=0;k<y.length;k++)0<k&&(P+=i),P+=f(y[k],k);0<a.length&&(P+=p)}for(var v=0;v<a.length;v++){var A=(B?y:a[v]).length,m=!1,R=B?Object.keys(a[v]).length===0:a[v].length===0;if($&&!B&&(m=$==="greedy"?a[v].join("").trim()==="":a[v].length===1&&a[v][0].length===0),$==="greedy"&&B){for(var q=[],O=0;O<A;O++){var x=V?y[O]:O;q.push(a[v][x])}m=q.join("").trim()===""}if(!m){for(var g=0;g<A;g++){0<g&&!R&&(P+=i);var H=B&&V?y[g]:g;P+=f(a[v][H],g)}v<a.length-1&&(!$||0<A&&!R)&&(P+=p)}}return P}function f(y,a){var $,P;return y==null?"":y.constructor===Date?JSON.stringify(y).slice(1,25):(P=!1,I&&typeof y=="string"&&I.test(y)&&(y="'"+y,P=!0),$=y.toString().replace(h,G),(P=P||r===!0||typeof r=="function"&&r(y,a)||Array.isArray(r)&&r[a]||((B,V)=>{for(var k=0;k<V.length;k++)if(-1<B.indexOf(V[k]))return!0;return!1})($,o.BAD_DELIMITERS)||-1<$.indexOf(i)||$.charAt(0)===" "||$.charAt($.length-1)===" ")?K+$+K:$)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!l&&!!c.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=Y,o.ParserHandle=Z,o.NetworkStreamer=ne,o.FileStreamer=b,o.StringStreamer=E,o.ReadableStreamStreamer=F,c.jQuery&&((u=c.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(p){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&c.FileReader)||!this.files||this.files.length===0)return!0;for(var K=0;K<this.files.length;K++)r.push({file:this.files[K],inputElem:this,instanceConfig:u.extend({},t)})}),s(),this;function s(){if(r.length===0)S(e.complete)&&e.complete();else{var p,K,G,X,_=r[0];if(S(e.before)){var I=e.before(_.file,_.inputElem);if(typeof I=="object"){if(I.action==="abort")return p="AbortError",K=_.file,G=_.inputElem,X=I.reason,void(S(e.error)&&e.error({name:p},K,G,X));if(I.action==="skip")return void i();typeof I.config=="object"&&(_.instanceConfig=u.extend(_.instanceConfig,I.config))}else if(I==="skip")return void i()}var h=_.instanceConfig.complete;_.instanceConfig.complete=function(U){S(h)&&h(U,_.file,_.inputElem),i()},o.parse(_.file,_.instanceConfig)}}function i(){r.splice(0,1),s()}}),L&&(c.onmessage=function(e){e=e.data,o.WORKER_ID===void 0&&e&&(o.WORKER_ID=e.workerId),typeof e.input=="string"?c.postMessage({workerId:o.WORKER_ID,results:o.parse(e.input,e.config),finished:!0}):(c.File&&e.input instanceof File||e.input instanceof Object)&&(e=o.parse(e.input,e.config))&&c.postMessage({workerId:o.WORKER_ID,results:e,finished:!0})}),(ne.prototype=Object.create(D.prototype)).constructor=ne,(b.prototype=Object.create(D.prototype)).constructor=b,(E.prototype=Object.create(E.prototype)).constructor=E,(F.prototype=Object.create(D.prototype)).constructor=F,o})}(pe)),pe.exports}var We=Ne();const Je=Ue(We),ye=[{id:"phone",name:"市外局番 から 都道府県",csvPath:"/data/phone.csv",promptKey:"phoneCode",answerKey:"prefecture",choiceCount:4,promptTemplate:n=>`市外局番 ${n.phoneCode} はどの県？`,choiceTemplate:n=>n.prefecture},{id:"phone-to-region",name:"市外局番 から 地域",csvPath:"/data/phone.csv",promptKey:"phoneCode",answerKey:"region",choiceCount:4,promptTemplate:n=>`${n.phoneCode} の地域は？`,choiceTemplate:n=>`${n.region}（${n.yomigana}）`},{id:"region-to-phone",name:"地域 から 市外局番",csvPath:"/data/phone.csv",promptKey:"region",answerKey:"phoneCode",choiceCount:4,promptTemplate:n=>`${n.region}（${n.yomigana}） の市外局番は？`,choiceTemplate:n=>`${n.phoneCode}`},{id:"region-to-pref",name:"地域 から 都道府県",csvPath:"/data/phone.csv",promptKey:"region",answerKey:"prefecture",choiceCount:4,promptTemplate:n=>`${n.region}（${n.yomigana}） の都道府県は？`,choiceTemplate:n=>n.prefecture},{id:"pref-to-region",name:"都道府県 から 地域",csvPath:"/data/phone.csv",promptKey:"prefecture",answerKey:"region",choiceCount:4,promptTemplate:n=>`${n.prefecture} の地域は？`,choiceTemplate:n=>`${n.region}（${n.yomigana}）`},{id:"prefecture-to-phone",name:"都道府県 から 市外局番",csvPath:"/data/phone.csv",promptKey:"prefecture",answerKey:"phoneCode",choiceCount:4,promptTemplate:n=>`${n.prefecture}の市外局番は？`,choiceTemplate:n=>`${n.phoneCode}`}],me=n=>[...n].sort(()=>Math.random()-.5),De=document.getElementById("nav"),ke=document.getElementById("stop-btn"),ae=document.getElementById("app"),xe=document.getElementById("progress-btn"),Se=document.getElementById("theme-toggle-btn"),Me=()=>{ae.innerHTML="";const n=document.createElement("div");n.className="main-menu",ye.forEach(d=>{const w=document.createElement("button");w.textContent=d.name,w.onclick=()=>Ke(d.id),n.appendChild(w)}),ae.appendChild(n)};Me();let ge=[],_e=0,fe=!1,Ce=ze();async function Qe(){fe=!1,ae.innerHTML="",ke.hidden=!1;const n=document.createElement("select");ye.forEach(o=>{const D=document.createElement("option");D.value=o.id,D.textContent=o.name,n.appendChild(D)});const d=document.createElement("label");d.textContent="問題セット: ",d.appendChild(n),ae.appendChild(d);let w=await be(n.value);n.onchange=async()=>{w=await be(n.value),M()};const c=document.createElement("table");c.className="stat-table",c.innerHTML=`
    <thead><tr>
      <th>問題</th><th>正答</th><th>正答数</th><th>出題数</th><th>正答率</th>
    </tr></thead>
    <tbody></tbody>`;const u=c.tBodies[0];let l="rate",L=-1;const M=()=>{u.innerHTML="";const o=Pe();w.map(b=>({card:b,stat:o[b.id]??{asked:0,correct:0}})).sort((b,E)=>{let F=0;if(l==="prompt")F=(b.card.prompt.type==="text"?b.card.prompt.text:"").localeCompare(E.card.prompt.type==="text"?E.card.prompt.text:"");else if(l==="answer"){const Z=(b.card.choices.find(Y=>Y.id===b.card.answer)??{type:"text"}).type==="text"?b.card.choices.find(Y=>Y.id===b.card.answer).text:"",J=(E.card.choices.find(Y=>Y.id===E.card.answer)??{type:"text"}).type==="text"?E.card.choices.find(Y=>Y.id===E.card.answer).text:"";F=Z.localeCompare(J)}else l==="correct"?F=b.stat.correct-E.stat.correct:l==="asked"?F=b.stat.asked-E.stat.asked:F=(b.stat.asked?b.stat.correct/b.stat.asked:0)-(E.stat.asked?E.stat.correct/E.stat.asked:0);return F*L}).forEach(({card:b,stat:E})=>{const F=E.asked?(E.correct/E.asked*100).toFixed(0):"0",Z=document.createElement("tr"),J=b.choices.find(we=>we.id===b.answer),Y=(J==null?void 0:J.type)==="text"?J.text:"[画像]";Z.innerHTML=`
        <td>${b.prompt.type==="text"?b.prompt.text.slice(0,20):"[画像]"}</td>
        <td>${Y.slice(0,20)}</td>
        <td>${E.correct}</td>
        <td>${E.asked}</td>
        <td>${F}%</td>`,u.appendChild(Z)})},W=c.tHead.rows[0].cells;["prompt","answer","correct","asked","rate"].forEach((o,D)=>{W[D].style.cursor="pointer",W[D].onclick=()=>{l===o?L=L===1?-1:1:(l=o,L=-1),["問題","正答","正答数","出題数","正答率"].forEach((ne,b)=>W[b].textContent=ne),W[D].textContent+=L===-1?" ▼":" ▲",M()}}),W[4].textContent+=" ▼",ae.appendChild(c),M()}xe.onclick=Qe;const Pe=()=>{const n={};return Ce.forEach(d=>{var c;const w=n[c=d.cardId]??(n[c]={asked:0,correct:0});w.asked+=1,d.correct&&(w.correct+=1)}),n},be=async n=>{const d=ye.find(M=>M.id===n);if(!d)throw new Error(`Unknown quiz config: ${n}`);const w=await(await fetch(d.csvPath)).text(),{data:c}=Je.parse(w,{header:!0}),u=c.filter(M=>Object.values(M).some(W=>W)),l=new Map;u.forEach(M=>{const W=`${M[d.promptKey]}|${M[d.answerKey]}`;l.has(W)||l.set(W,M)});const L=Array.from(l.values());return me(L.map(M=>{const W=M[d.answerKey],o=M[d.promptKey],D=new Set([o]),ne=me(Array.from(new Set(L.map(E=>E[d.answerKey]))).filter(E=>{var Z;const F=(Z=L.find(J=>J[d.answerKey]===E))==null?void 0:Z[d.promptKey];return F&&!D.has(F)?(D.add(F),!0):!1})).slice(0,d.choiceCount-1),b=me([W,...ne]).map(E=>{const F=L.find(Z=>Z[d.answerKey]===E);return{id:E,type:"text",text:d.choiceTemplate(F)}});return{id:`${n}:${o}`,prompt:{type:"text",text:d.promptTemplate(M)},choices:b,answer:W,tags:[n]}}))},Fe=()=>{if(!fe)return;_e>=ge.length&&(_e=0,me(ge));const n=ge[_e++],d=Pe();qe(n,d[n.id],(w,c)=>{Ce.push({ts:Date.now(),cardId:n.id,choiceId:c,correct:w}),Be(Ce);const u=document.querySelector(`.choice[data-id="${c}"]`),l=document.querySelector(`.choice[data-id="${n.answer}"]`);w?u==null||u.classList.add("highlight-correct"):(u==null||u.classList.add("highlight-incorrect"),l==null||l.classList.add("highlight-correct")),document.querySelectorAll(".choice").forEach(L=>{L.onclick=()=>{Fe()}})})},Ke=async n=>{fe=!1,ae.innerHTML="",ge=await be(n),_e=0,ke.hidden=!1,xe.hidden=!0,fe=!0,Fe()},Ye=()=>{fe=!1,ae.innerHTML="",ke.hidden=!0,De.hidden=!1,xe.hidden=!1,Me()};De.querySelectorAll("button").forEach(n=>{const d=ye.find(w=>w.id===n.dataset.set);d&&(n.textContent=d.name,n.onclick=()=>Ke(d.id))});ke.onclick=Ye;const Ze=localStorage.getItem("theme");Ze==="dark"&&(document.body.classList.add("dark-mode"),Se.textContent="ライトモード");const Ge=()=>{const n=document.body.classList.toggle("dark-mode");Se.textContent=n?"ライトモード":"ダークモード",localStorage.setItem("theme",n?"dark":"light")};Se.onclick=Ge;
