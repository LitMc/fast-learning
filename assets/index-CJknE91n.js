(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const l of u)if(l.type==="childList")for(const L of l.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&c(L)}).observe(document,{childList:!0,subtree:!0});function w(u){const l={};return u.integrity&&(l.integrity=u.integrity),u.referrerPolicy&&(l.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?l.credentials="include":u.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(u){if(u.ep)return;u.ep=!0;const l=w(u);fetch(u.href,l)}})();const le=document.getElementById("app");function ae(n,d={},w=[]){const c=document.createElement(n);return Object.entries(d).forEach(([u,l])=>c.setAttribute(u,l)),w.forEach(u=>c.appendChild(typeof u=="string"?document.createTextNode(u):u)),c}function Ke(n){return n.type==="text"?ae("h2",{},[n.text]):n.type==="image"?ae("img",{src:n.src,width:"200"}):ae("p",{},["Unsupported prompt"])}function je(n,d){const w=ae("button",{class:"choice","data-id":n.id});return n.type==="text"?w.textContent=n.text:(w.classList.add("img-choice"),w.appendChild(ae("img",{src:n.src,width:"120"}))),w.onclick=d,w}function qe(n,d,w){if(le.innerHTML="",d){const l=(d.correct/d.asked*100).toFixed(0);le.appendChild(ae("p",{class:"stat"},[`正答 ${d.correct}/${d.asked} (${l}%)`]))}else le.appendChild(ae("p",{class:"stat"},["正答 0/0 (0%)"]));le.appendChild(Ke(n.prompt));const c=ae("div",{class:"choices"});[...n.choices].sort(()=>Math.random()-.5).forEach(l=>c.appendChild(je(l,()=>{const L=l.id===n.answer;w(L,l.id)}))),le.appendChild(c)}const Ae="memorizer-history-v1";function ze(){try{return JSON.parse(localStorage.getItem(Ae)||"[]")}catch{return[]}}function Be(n){localStorage.setItem(Ae,JSON.stringify(n))}function Ue(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var pe={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var He=pe.exports,Ie;function Ne(){return Ie||(Ie=1,function(n,d){((w,c)=>{n.exports=c()})(He,function w(){var c=typeof self<"u"?self:typeof window<"u"?window:c!==void 0?c:{},u,l=!c.document&&!!c.postMessage,L=c.IS_PAPA_WORKER||!1,M={},W=0,a={};function D(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var r=ve(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new Z(r),(this._handle.streamer=this)._config=r}).call(this,e),this.parseChunk=function(t,r){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let p=this._config.newline;p||(i=this._config.quoteChar||'"',p=this._handle.guessLineEndings(t,i)),t=[...t.split(p).slice(s)].join(p)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t,i=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,s=(this._finished||(this._partialLine=s.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),L)c.postMessage({results:i,workerId:a.WORKER_ID,finished:s});else if(S(this._config.chunk)&&!r){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!S(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){S(this._config.error)?this._config.error(t):L&&this._config.error&&c.postMessage({workerId:a.WORKER_ID,error:t,finished:!1})}}function ne(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),D.call(this,e),this._nextChunk=l?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),l||(t.onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!l),this._config.downloadRequestHeaders){var r,s=this._config.downloadRequestHeaders;for(r in s)t.setRequestHeader(r,s[r])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(p){this._chunkError(p.message)}l&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function b(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),D.call(this,e);var t,r,s=typeof FileReader<"u";this.stream=function(i){this._input=i,r=i.slice||i.webkitSlice||i.mozSlice,s?((t=new FileReader).onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,p=(this._config.chunkSize&&(p=Math.min(this._start+this._config.chunkSize,this._input.size),i=r.call(i,this._start,p)),t.readAsText(i,this._config.encoding));s||this._chunkLoaded({target:{result:p}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function E(e){var t;D.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,s;if(!this._finished)return r=this._config.chunkSize,t=r?(s=t.substring(0,r),t.substring(r)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function P(e){D.call(this,e=e||{});var t=[],r=!0,s=!1;this.pause=function(){D.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){D.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=se(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(p){this._streamError(p)}},this),this._streamError=se(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=se(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Z(e){var t,r,s,i,p=Math.pow(2,53),F=-p,G=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,X=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,_=this,I=0,h=0,U=!1,f=!1,y=[],o={data:[],errors:[],meta:{}};function K(k){return e.skipEmptyLines==="greedy"?k.join("").trim()==="":k.length===1&&k[0].length===0}function $(){if(o&&s&&(V("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(o.data=o.data.filter(function(R){return!K(R)})),B()){let R=function(q,O){S(e.transformHeader)&&(q=e.transformHeader(q,O)),y.push(q)};var g=R;if(o)if(Array.isArray(o.data[0])){for(var k=0;B()&&k<o.data.length;k++)o.data[k].forEach(R);o.data.splice(0,1)}else o.data.forEach(R)}function v(R,q){for(var O=e.header?{}:[],x=0;x<R.length;x++){var m=x,H=R[x],H=((C,T)=>(j=>(e.dynamicTypingFunction&&e.dynamicTyping[j]===void 0&&(e.dynamicTyping[j]=e.dynamicTypingFunction(j)),(e.dynamicTyping[j]||e.dynamicTyping)===!0))(C)?T==="true"||T==="TRUE"||T!=="false"&&T!=="FALSE"&&((j=>{if(G.test(j)&&(j=parseFloat(j),F<j&&j<p))return 1})(T)?parseFloat(T):X.test(T)?new Date(T):T===""?null:T):T)(m=e.header?x>=y.length?"__parsed_extra":y[x]:m,H=e.transform?e.transform(H,m):H);m==="__parsed_extra"?(O[m]=O[m]||[],O[m].push(H)):O[m]=H}return e.header&&(x>y.length?V("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+x,h+q):x<y.length&&V("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+x,h+q)),O}var A;o&&(e.header||e.dynamicTyping||e.transform)&&(A=1,!o.data.length||Array.isArray(o.data[0])?(o.data=o.data.map(v),A=o.data.length):o.data=v(o.data,0),e.header&&o.meta&&(o.meta.fields=y),h+=A)}function B(){return e.header&&y.length===0}function V(k,v,A,g){k={type:k,code:v,message:A},g!==void 0&&(k.row=g),o.errors.push(k)}S(e.step)&&(i=e.step,e.step=function(k){o=k,B()?$():($(),o.data.length!==0&&(I+=k.data.length,e.preview&&I>e.preview?r.abort():(o.data=o.data[0],i(o,_))))}),this.parse=function(k,v,A){var g=e.quoteChar||'"',g=(e.newline||(e.newline=this.guessLineEndings(k,g)),s=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(k),o.meta.delimiter=e.delimiter):((g=((R,q,O,x,m)=>{var H,C,T,j;m=m||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var ce=0;ce<m.length;ce++){for(var ee,he=m[ce],N=0,te=0,z=0,Q=(T=void 0,new Y({comments:x,delimiter:he,newline:q,preview:10}).parse(R)),ie=0;ie<Q.data.length;ie++)O&&K(Q.data[ie])?z++:(ee=Q.data[ie].length,te+=ee,T===void 0?T=ee:0<ee&&(N+=Math.abs(ee-T),T=ee));0<Q.data.length&&(te/=Q.data.length-z),(C===void 0||N<=C)&&(j===void 0||j<te)&&1.99<te&&(C=N,H=he,j=te)}return{successful:!!(e.delimiter=H),bestDelimiter:H}})(k,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=g.bestDelimiter:(s=!0,e.delimiter=a.DefaultDelimiter),o.meta.delimiter=e.delimiter),ve(e));return e.preview&&e.header&&g.preview++,t=k,r=new Y(g),o=r.parse(t,v,A),$(),U?{meta:{paused:!0}}:o||{meta:{paused:!1}}},this.paused=function(){return U},this.pause=function(){U=!0,r.abort(),t=S(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){_.streamer._halted?(U=!1,_.streamer.parseChunk(t,!0)):setTimeout(_.resume,3)},this.aborted=function(){return f},this.abort=function(){f=!0,r.abort(),o.meta.aborted=!0,S(e.complete)&&e.complete(o),t=""},this.guessLineEndings=function(R,g){R=R.substring(0,1048576);var g=new RegExp(J(g)+"([^]*?)"+J(g),"gm"),A=(R=R.replace(g,"")).split("\r"),g=R.split(`
`),R=1<g.length&&g[0].length<A[0].length;if(A.length===1||R)return`
`;for(var q=0,O=0;O<A.length;O++)A[O][0]===`
`&&q++;return q>=A.length/2?`\r
`:"\r"}}function J(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Y(e){var t=(e=e||{}).delimiter,r=e.newline,s=e.comments,i=e.step,p=e.preview,F=e.fastMode,G=null,X=!1,_=e.quoteChar==null?'"':e.quoteChar,I=_;if(e.escapeChar!==void 0&&(I=e.escapeChar),(typeof t!="string"||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");s===!0?s="#":(typeof s!="string"||-1<a.BAD_DELIMITERS.indexOf(s))&&(s=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var h=0,U=!1;this.parse=function(f,y,o){if(typeof f!="string")throw new Error("Input must be a string");var K=f.length,$=t.length,B=r.length,V=s.length,k=S(i),v=[],A=[],g=[],R=h=0;if(!f)return N();if(F||F!==!1&&f.indexOf(_)===-1){for(var q=f.split(r),O=0;O<q.length;O++){if(g=q[O],h+=g.length,O!==q.length-1)h+=r.length;else if(o)return N();if(!s||g.substring(0,V)!==s){if(k){if(v=[],j(g.split(t)),te(),U)return N()}else j(g.split(t));if(p&&p<=O)return v=v.slice(0,p),N(!0)}}return N()}for(var x=f.indexOf(t,h),m=f.indexOf(r,h),H=new RegExp(J(I)+J(_),"g"),C=f.indexOf(_,h);;)if(f[h]===_)for(C=h,h++;;){if((C=f.indexOf(_,C+1))===-1)return o||A.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:h}),ee();if(C===K-1)return ee(f.substring(h,C).replace(H,_));if(_===I&&f[C+1]===I)C++;else if(_===I||C===0||f[C-1]!==I){x!==-1&&x<C+1&&(x=f.indexOf(t,C+1));var T=ce((m=m!==-1&&m<C+1?f.indexOf(r,C+1):m)===-1?x:Math.min(x,m));if(f.substr(C+1+T,$)===t){g.push(f.substring(h,C).replace(H,_)),f[h=C+1+T+$]!==_&&(C=f.indexOf(_,h)),x=f.indexOf(t,h),m=f.indexOf(r,h);break}if(T=ce(m),f.substring(C+1+T,C+1+T+B)===r){if(g.push(f.substring(h,C).replace(H,_)),he(C+1+T+B),x=f.indexOf(t,h),C=f.indexOf(_,h),k&&(te(),U))return N();if(p&&v.length>=p)return N(!0);break}A.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:h}),C++}}else if(s&&g.length===0&&f.substring(h,h+V)===s){if(m===-1)return N();h=m+B,m=f.indexOf(r,h),x=f.indexOf(t,h)}else if(x!==-1&&(x<m||m===-1))g.push(f.substring(h,x)),h=x+$,x=f.indexOf(t,h);else{if(m===-1)break;if(g.push(f.substring(h,m)),he(m+B),k&&(te(),U))return N();if(p&&v.length>=p)return N(!0)}return ee();function j(z){v.push(z),R=h}function ce(z){var Q=0;return Q=z!==-1&&(z=f.substring(C+1,z))&&z.trim()===""?z.length:Q}function ee(z){return o||(z===void 0&&(z=f.substring(h)),g.push(z),h=K,j(g),k&&te()),N()}function he(z){h=z,j(g),g=[],m=f.indexOf(r,h)}function N(z){if(e.header&&!y&&v.length&&!X){var Q=v[0],ie={},Ee=new Set(Q);let Te=!1;for(let de=0;de<Q.length;de++){let re=Q[de];if(ie[re=S(e.transformHeader)?e.transformHeader(re,de):re]){let ue,Le=ie[re];for(;ue=re+"_"+Le,Le++,Ee.has(ue););Ee.add(ue),Q[de]=ue,ie[re]++,Te=!0,(G=G===null?{}:G)[ue]=re}else ie[re]=1,Q[de]=re;Ee.add(re)}Te&&console.warn("Duplicate headers found and renamed."),X=!0}return{data:v,errors:A,meta:{delimiter:t,linebreak:r,aborted:U,truncated:!!z,cursor:R+(y||0),renamedHeaders:G}}}function te(){i(N()),v=[],A=[]}},this.abort=function(){U=!0},this.getCharIndex=function(){return h}}function we(e){var t=e.data,r=M[t.workerId],s=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){s=!0,Re(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Oe,resume:Oe};if(S(r.userStep)){for(var p=0;p<t.results.data.length&&(r.userStep({data:t.results.data[p],errors:t.results.errors,meta:t.results.meta},i),!s);p++);delete t.results}else S(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!s&&Re(t.workerId,t.results)}function Re(e,t){var r=M[e];S(r.userComplete)&&r.userComplete(t),r.terminate(),delete M[e]}function Oe(){throw new Error("Not implemented.")}function ve(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ve(e[t]);return r}function se(e,t){return function(){e.apply(t,arguments)}}function S(e){return typeof e=="function"}return a.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(S(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!S(t.transform)&&t.transform,!t.worker||!a.WORKERS_SUPPORTED)return r=null,a.NODE_STREAM_INPUT,typeof e=="string"?(e=(s=>s.charCodeAt(0)!==65279?s:s.slice(1))(e),r=new(t.download?ne:E)(t)):e.readable===!0&&S(e.read)&&S(e.on)?r=new P(t):(c.File&&e instanceof File||e instanceof Object)&&(r=new b(t)),r.stream(e);(r=(()=>{var s;return!!a.WORKERS_SUPPORTED&&(s=(()=>{var i=c.URL||c.webkitURL||null,p=w.toString();return a.BLOB_URL||(a.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",p,")();"],{type:"text/javascript"})))})(),(s=new c.Worker(s)).onmessage=we,s.id=W++,M[s.id]=s)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=S(t.step),t.chunk=S(t.chunk),t.complete=S(t.complete),t.error=S(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},a.unparse=function(e,t){var r=!1,s=!0,i=",",p=`\r
`,F='"',G=F+F,X=!1,_=null,I=!1,h=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||a.BAD_DELIMITERS.filter(function(y){return t.delimiter.indexOf(y)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(X=t.skipEmptyLines),typeof t.newline=="string"&&(p=t.newline),typeof t.quoteChar=="string"&&(F=t.quoteChar),typeof t.header=="boolean"&&(s=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}t.escapeChar!==void 0&&(G=t.escapeChar+F),t.escapeFormulae instanceof RegExp?I=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(I=/^[=+\-@\t\r].*$/)}})(),new RegExp(J(F),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return U(null,e,X);if(typeof e[0]=="object")return U(_||Object.keys(e[0]),e,X)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||_),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),U(e.fields||[],e.data||[],X);throw new Error("Unable to serialize unrecognized input");function U(y,o,K){var $="",B=(typeof y=="string"&&(y=JSON.parse(y)),typeof o=="string"&&(o=JSON.parse(o)),Array.isArray(y)&&0<y.length),V=!Array.isArray(o[0]);if(B&&s){for(var k=0;k<y.length;k++)0<k&&($+=i),$+=f(y[k],k);0<o.length&&($+=p)}for(var v=0;v<o.length;v++){var A=(B?y:o[v]).length,g=!1,R=B?Object.keys(o[v]).length===0:o[v].length===0;if(K&&!B&&(g=K==="greedy"?o[v].join("").trim()==="":o[v].length===1&&o[v][0].length===0),K==="greedy"&&B){for(var q=[],O=0;O<A;O++){var x=V?y[O]:O;q.push(o[v][x])}g=q.join("").trim()===""}if(!g){for(var m=0;m<A;m++){0<m&&!R&&($+=i);var H=B&&V?y[m]:m;$+=f(o[v][H],m)}v<o.length-1&&(!K||0<A&&!R)&&($+=p)}}return $}function f(y,o){var K,$;return y==null?"":y.constructor===Date?JSON.stringify(y).slice(1,25):($=!1,I&&typeof y=="string"&&I.test(y)&&(y="'"+y,$=!0),K=y.toString().replace(h,G),($=$||r===!0||typeof r=="function"&&r(y,o)||Array.isArray(r)&&r[o]||((B,V)=>{for(var k=0;k<V.length;k++)if(-1<B.indexOf(V[k]))return!0;return!1})(K,a.BAD_DELIMITERS)||-1<K.indexOf(i)||K.charAt(0)===" "||K.charAt(K.length-1)===" ")?F+K+F:K)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!l&&!!c.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=Y,a.ParserHandle=Z,a.NetworkStreamer=ne,a.FileStreamer=b,a.StringStreamer=E,a.ReadableStreamStreamer=P,c.jQuery&&((u=c.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(p){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&c.FileReader)||!this.files||this.files.length===0)return!0;for(var F=0;F<this.files.length;F++)r.push({file:this.files[F],inputElem:this,instanceConfig:u.extend({},t)})}),s(),this;function s(){if(r.length===0)S(e.complete)&&e.complete();else{var p,F,G,X,_=r[0];if(S(e.before)){var I=e.before(_.file,_.inputElem);if(typeof I=="object"){if(I.action==="abort")return p="AbortError",F=_.file,G=_.inputElem,X=I.reason,void(S(e.error)&&e.error({name:p},F,G,X));if(I.action==="skip")return void i();typeof I.config=="object"&&(_.instanceConfig=u.extend(_.instanceConfig,I.config))}else if(I==="skip")return void i()}var h=_.instanceConfig.complete;_.instanceConfig.complete=function(U){S(h)&&h(U,_.file,_.inputElem),i()},a.parse(_.file,_.instanceConfig)}}function i(){r.splice(0,1),s()}}),L&&(c.onmessage=function(e){e=e.data,a.WORKER_ID===void 0&&e&&(a.WORKER_ID=e.workerId),typeof e.input=="string"?c.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(c.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&c.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(ne.prototype=Object.create(D.prototype)).constructor=ne,(b.prototype=Object.create(D.prototype)).constructor=b,(E.prototype=Object.create(E.prototype)).constructor=E,(P.prototype=Object.create(D.prototype)).constructor=P,a})}(pe)),pe.exports}var We=Ne();const Je=Ue(We),ye=[{id:"phone",name:"市外局番 から 都道府県",csvPath:"/fast-learning/data/phone.csv",promptKey:"phoneCode",answerKey:"prefecture",choiceCount:4,promptTemplate:n=>`市外局番 ${n.phoneCode} はどの県？`,choiceTemplate:n=>n.prefecture},{id:"phone-to-region",name:"市外局番 から 地域",csvPath:"/fast-learning/data/phone.csv",promptKey:"phoneCode",answerKey:"region",choiceCount:4,promptTemplate:n=>`${n.phoneCode} の地域は？`,choiceTemplate:n=>`${n.region}（${n.yomigana}）`},{id:"region-to-phone",name:"地域 から 市外局番",csvPath:"/fast-learning/data/phone.csv",promptKey:"region",answerKey:"phoneCode",choiceCount:4,promptTemplate:n=>`${n.region}（${n.yomigana}） の市外局番は？`,choiceTemplate:n=>`${n.phoneCode}`},{id:"region-to-pref",name:"地域 から 都道府県",csvPath:"/fast-learning/data/phone.csv",promptKey:"region",answerKey:"prefecture",choiceCount:4,promptTemplate:n=>`${n.region}（${n.yomigana}） の都道府県は？`,choiceTemplate:n=>n.prefecture},{id:"pref-to-region",name:"都道府県 から 地域",csvPath:"/fast-learning/data/phone.csv",promptKey:"prefecture",answerKey:"region",choiceCount:4,promptTemplate:n=>`${n.prefecture} の地域は？`,choiceTemplate:n=>`${n.region}（${n.yomigana}）`},{id:"prefecture-to-phone",name:"都道府県 から 市外局番",csvPath:"/fast-learning/data/phone.csv",promptKey:"prefecture",answerKey:"phoneCode",choiceCount:4,promptTemplate:n=>`${n.prefecture}の市外局番は？`,choiceTemplate:n=>`${n.phoneCode}`}],ge=n=>[...n].sort(()=>Math.random()-.5),De=document.getElementById("nav"),ke=document.getElementById("stop-btn"),oe=document.getElementById("app"),xe=document.getElementById("progress-btn"),Se=document.getElementById("theme-toggle-btn"),Me=()=>{oe.innerHTML="";const n=document.createElement("div");n.className="main-menu",ye.forEach(d=>{const w=document.createElement("button");w.textContent=d.name,w.onclick=()=>Fe(d.id),n.appendChild(w)}),oe.appendChild(n)};Me();let me=[],_e=0,fe=!1,Ce=ze();async function Qe(){fe=!1,oe.innerHTML="",ke.hidden=!1;const n=document.createElement("select");ye.forEach(a=>{const D=document.createElement("option");D.value=a.id,D.textContent=a.name,n.appendChild(D)});const d=document.createElement("label");d.textContent="問題セット: ",d.appendChild(n),oe.appendChild(d);let w=await be(n.value);n.onchange=async()=>{w=await be(n.value),M()};const c=document.createElement("table");c.className="stat-table",c.innerHTML=`
    <thead><tr>
      <th>問題</th><th>正答</th><th>正答数</th><th>出題数</th><th>正答率</th>
    </tr></thead>
    <tbody></tbody>`;const u=c.tBodies[0];let l="rate",L=-1;const M=()=>{u.innerHTML="";const a=$e();w.map(b=>({card:b,stat:a[b.id]??{asked:0,correct:0}})).sort((b,E)=>{let P=0;if(l==="prompt")P=(b.card.prompt.type==="text"?b.card.prompt.text:"").localeCompare(E.card.prompt.type==="text"?E.card.prompt.text:"");else if(l==="answer"){const Z=(b.card.choices.find(Y=>Y.id===b.card.answer)??{type:"text"}).type==="text"?b.card.choices.find(Y=>Y.id===b.card.answer).text:"",J=(E.card.choices.find(Y=>Y.id===E.card.answer)??{type:"text"}).type==="text"?E.card.choices.find(Y=>Y.id===E.card.answer).text:"";P=Z.localeCompare(J)}else l==="correct"?P=b.stat.correct-E.stat.correct:l==="asked"?P=b.stat.asked-E.stat.asked:P=(b.stat.asked?b.stat.correct/b.stat.asked:0)-(E.stat.asked?E.stat.correct/E.stat.asked:0);return P*L}).forEach(({card:b,stat:E})=>{const P=E.asked?(E.correct/E.asked*100).toFixed(0):"0",Z=document.createElement("tr"),J=b.choices.find(we=>we.id===b.answer),Y=(J==null?void 0:J.type)==="text"?J.text:"[画像]";Z.innerHTML=`
        <td>${b.prompt.type==="text"?b.prompt.text.slice(0,20):"[画像]"}</td>
        <td>${Y.slice(0,20)}</td>
        <td>${E.correct}</td>
        <td>${E.asked}</td>
        <td>${P}%</td>`,u.appendChild(Z)})},W=c.tHead.rows[0].cells;["prompt","answer","correct","asked","rate"].forEach((a,D)=>{W[D].style.cursor="pointer",W[D].onclick=()=>{l===a?L=L===1?-1:1:(l=a,L=-1),["問題","正答","正答数","出題数","正答率"].forEach((ne,b)=>W[b].textContent=ne),W[D].textContent+=L===-1?" ▼":" ▲",M()}}),W[4].textContent+=" ▼",oe.appendChild(c),M()}xe.onclick=Qe;const $e=()=>{const n={};return Ce.forEach(d=>{var c;const w=n[c=d.cardId]??(n[c]={asked:0,correct:0});w.asked+=1,d.correct&&(w.correct+=1)}),n},be=async n=>{const d=ye.find(M=>M.id===n);if(!d)throw new Error(`Unknown quiz config: ${n}`);const w=await(await fetch(d.csvPath)).text(),{data:c}=Je.parse(w,{header:!0}),u=c.filter(M=>Object.values(M).some(W=>W)),l=new Map;u.forEach(M=>{const W=`${M[d.promptKey]}|${M[d.answerKey]}`;l.has(W)||l.set(W,M)});const L=Array.from(l.values());return ge(L.map(M=>{const W=M[d.answerKey],a=M[d.promptKey],D=new Set([a]),ne=ge(Array.from(new Set(L.map(E=>E[d.answerKey]))).filter(E=>{var Z;const P=(Z=L.find(J=>J[d.answerKey]===E))==null?void 0:Z[d.promptKey];return P&&!D.has(P)?(D.add(P),!0):!1})).slice(0,d.choiceCount-1),b=ge([W,...ne]).map(E=>{const P=L.find(Z=>Z[d.answerKey]===E);return{id:E,type:"text",text:d.choiceTemplate(P)}});return{id:`${n}:${a}`,prompt:{type:"text",text:d.promptTemplate(M)},choices:b,answer:W,tags:[n]}}))},Pe=()=>{if(!fe)return;_e>=me.length&&(_e=0,ge(me));const n=me[_e++],d=$e();qe(n,d[n.id],(w,c)=>{Ce.push({ts:Date.now(),cardId:n.id,choiceId:c,correct:w}),Be(Ce);const u=document.querySelector(`.choice[data-id="${c}"]`),l=document.querySelector(`.choice[data-id="${n.answer}"]`);w?u==null||u.classList.add("highlight-correct"):(u==null||u.classList.add("highlight-incorrect"),l==null||l.classList.add("highlight-correct")),document.querySelectorAll(".choice").forEach(L=>{L.onclick=()=>{Pe()}})})},Fe=async n=>{fe=!1,oe.innerHTML="",me=await be(n),_e=0,ke.hidden=!1,xe.hidden=!0,fe=!0,Pe()},Ye=()=>{fe=!1,oe.innerHTML="",ke.hidden=!0,De.hidden=!1,xe.hidden=!1,Me()};De.querySelectorAll("button").forEach(n=>{const d=ye.find(w=>w.id===n.dataset.set);d&&(n.textContent=d.name,n.onclick=()=>Fe(d.id))});ke.onclick=Ye;const Ze=localStorage.getItem("theme");Ze==="dark"&&(document.body.classList.add("dark-mode"),Se.textContent="ライトモード");const Ge=()=>{const n=document.body.classList.toggle("dark-mode");Se.textContent=n?"ライトモード":"ダークモード",localStorage.setItem("theme",n?"dark":"light")};Se.onclick=Ge;
