(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const u of f)if(u.type==="childList")for(const l of u.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function C(f){const u={};return f.integrity&&(u.integrity=f.integrity),f.referrerPolicy&&(u.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?u.credentials="include":f.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function d(f){if(f.ep)return;f.ep=!0;const u=C(f);fetch(f.href,u)}})();const le=document.getElementById("app");function oe(n,c={},C=[]){const d=document.createElement(n);return Object.entries(c).forEach(([f,u])=>d.setAttribute(f,u)),C.forEach(f=>d.appendChild(typeof f=="string"?document.createTextNode(f):f)),d}function qe(n){return n.type==="text"?oe("h2",{},[n.text]):n.type==="image"?oe("img",{src:n.src,width:"200"}):oe("p",{},["Unsupported prompt"])}function je(n,c){const C=oe("button",{class:"choice","data-id":n.id});return n.type==="text"?C.textContent=n.text:(C.classList.add("img-choice"),C.appendChild(oe("img",{src:n.src,width:"120"}))),C.onclick=c,C}function ze(n,c,C){if(le.innerHTML="",c){const u=(c.correct/c.asked*100).toFixed(0);le.appendChild(oe("p",{class:"stat"},[`正答 ${c.correct}/${c.asked} (${u}%)`]))}else le.appendChild(oe("p",{class:"stat"},["正答 0/0 (0%)"]));le.appendChild(qe(n.prompt));const d=oe("div",{class:"choices"});[...n.choices].sort(()=>Math.random()-.5).forEach(u=>d.appendChild(je(u,()=>{const l=u.id===n.answer;C(l,u.id)}))),le.appendChild(d)}const Le="memorizer-history-v1";function Be(){try{return JSON.parse(localStorage.getItem(Le)||"[]")}catch{return[]}}function He(n){localStorage.setItem(Le,JSON.stringify(n))}function Ue(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ge={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var Ne=ge.exports,Ie;function We(){return Ie||(Ie=1,function(n,c){((C,d)=>{n.exports=d()})(Ne,function C(){var d=typeof self<"u"?self:typeof window<"u"?window:d!==void 0?d:{},f,u=!d.document&&!!d.postMessage,l=d.IS_PAPA_WORKER||!1,m={},A=0,o={};function D(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var r=ve(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new ae(r),(this._handle.streamer=this)._config=r}).call(this,e),this.parseChunk=function(t,r){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let g=this._config.newline;g||(i=this._config.quoteChar||'"',g=this._handle.guessLineEndings(t,i)),t=[...t.split(g).slice(s)].join(g)}this.isFirstChunk&&O(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t,i=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,s=(this._finished||(this._partialLine=s.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),l)d.postMessage({results:i,workerId:o.WORKER_ID,finished:s});else if(O(this._config.chunk)&&!r){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!O(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){O(this._config.error)?this._config.error(t):l&&this._config.error&&d.postMessage({workerId:o.WORKER_ID,error:t,finished:!1})}}function V(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),D.call(this,e),this._nextChunk=u?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),u||(t.onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!u),this._config.downloadRequestHeaders){var r,s=this._config.downloadRequestHeaders;for(r in s)t.setRequestHeader(r,s[r])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(g){this._chunkError(g.message)}u&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function k(e){(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),D.call(this,e);var t,r,s=typeof FileReader<"u";this.stream=function(i){this._input=i,r=i.slice||i.webkitSlice||i.mozSlice,s?((t=new FileReader).onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,g=(this._config.chunkSize&&(g=Math.min(this._start+this._config.chunkSize,this._input.size),i=r.call(i,this._start,g)),t.readAsText(i,this._config.encoding));s||this._chunkLoaded({target:{result:g}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function S(e){var t;D.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,s;if(!this._finished)return r=this._config.chunkSize,t=r?(s=t.substring(0,r),t.substring(r)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function B(e){D.call(this,e=e||{});var t=[],r=!0,s=!1;this.pause=function(){D.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){D.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=se(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(g){this._streamError(g)}},this),this._streamError=se(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=se(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ae(e){var t,r,s,i,g=Math.pow(2,53),K=-g,Z=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,G=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,w=this,$=0,h=0,U=!1,p=!1,v=[],a={data:[],errors:[],meta:{}};function P(E){return e.skipEmptyLines==="greedy"?E.join("").trim()==="":E.length===1&&E[0].length===0}function F(){if(a&&s&&(X("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(a.data=a.data.filter(function(T){return!P(T)})),H()){let T=function(j,I){O(e.transformHeader)&&(j=e.transformHeader(j,I)),v.push(j)};var y=T;if(a)if(Array.isArray(a.data[0])){for(var E=0;H()&&E<a.data.length;E++)a.data[E].forEach(T);a.data.splice(0,1)}else a.data.forEach(T)}function b(T,j){for(var I=e.header?{}:[],R=0;R<T.length;R++){var _=R,N=T[R],N=((x,L)=>(q=>(e.dynamicTypingFunction&&e.dynamicTyping[q]===void 0&&(e.dynamicTyping[q]=e.dynamicTypingFunction(q)),(e.dynamicTyping[q]||e.dynamicTyping)===!0))(x)?L==="true"||L==="TRUE"||L!=="false"&&L!=="FALSE"&&((q=>{if(Z.test(q)&&(q=parseFloat(q),K<q&&q<g))return 1})(L)?parseFloat(L):G.test(L)?new Date(L):L===""?null:L):L)(_=e.header?R>=v.length?"__parsed_extra":v[R]:_,N=e.transform?e.transform(N,_):N);_==="__parsed_extra"?(I[_]=I[_]||[],I[_].push(N)):I[_]=N}return e.header&&(R>v.length?X("FieldMismatch","TooManyFields","Too many fields: expected "+v.length+" fields but parsed "+R,h+j):R<v.length&&X("FieldMismatch","TooFewFields","Too few fields: expected "+v.length+" fields but parsed "+R,h+j)),I}var M;a&&(e.header||e.dynamicTyping||e.transform)&&(M=1,!a.data.length||Array.isArray(a.data[0])?(a.data=a.data.map(b),M=a.data.length):a.data=b(a.data,0),e.header&&a.meta&&(a.meta.fields=v),h+=M)}function H(){return e.header&&v.length===0}function X(E,b,M,y){E={type:E,code:b,message:M},y!==void 0&&(E.row=y),a.errors.push(E)}O(e.step)&&(i=e.step,e.step=function(E){a=E,H()?F():(F(),a.data.length!==0&&($+=E.data.length,e.preview&&$>e.preview?r.abort():(a.data=a.data[0],i(a,w))))}),this.parse=function(E,b,M){var y=e.quoteChar||'"',y=(e.newline||(e.newline=this.guessLineEndings(E,y)),s=!1,e.delimiter?O(e.delimiter)&&(e.delimiter=e.delimiter(E),a.meta.delimiter=e.delimiter):((y=((T,j,I,R,_)=>{var N,x,L,q;_=_||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var ce=0;ce<_.length;ce++){for(var ee,ue=_[ce],W=0,te=0,z=0,Q=(L=void 0,new J({comments:R,delimiter:ue,newline:j,preview:10}).parse(T)),ne=0;ne<Q.data.length;ne++)I&&P(Q.data[ne])?z++:(ee=Q.data[ne].length,te+=ee,L===void 0?L=ee:0<ee&&(W+=Math.abs(ee-L),L=ee));0<Q.data.length&&(te/=Q.data.length-z),(x===void 0||W<=x)&&(q===void 0||q<te)&&1.99<te&&(x=W,N=ue,q=te)}return{successful:!!(e.delimiter=N),bestDelimiter:N}})(E,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=y.bestDelimiter:(s=!0,e.delimiter=o.DefaultDelimiter),a.meta.delimiter=e.delimiter),ve(e));return e.preview&&e.header&&y.preview++,t=E,r=new J(y),a=r.parse(t,b,M),F(),U?{meta:{paused:!0}}:a||{meta:{paused:!1}}},this.paused=function(){return U},this.pause=function(){U=!0,r.abort(),t=O(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){w.streamer._halted?(U=!1,w.streamer.parseChunk(t,!0)):setTimeout(w.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,r.abort(),a.meta.aborted=!0,O(e.complete)&&e.complete(a),t=""},this.guessLineEndings=function(T,y){T=T.substring(0,1048576);var y=new RegExp(Y(y)+"([^]*?)"+Y(y),"gm"),M=(T=T.replace(y,"")).split("\r"),y=T.split(`
`),T=1<y.length&&y[0].length<M[0].length;if(M.length===1||T)return`
`;for(var j=0,I=0;I<M.length;I++)M[I][0]===`
`&&j++;return j>=M.length/2?`\r
`:"\r"}}function Y(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function J(e){var t=(e=e||{}).delimiter,r=e.newline,s=e.comments,i=e.step,g=e.preview,K=e.fastMode,Z=null,G=!1,w=e.quoteChar==null?'"':e.quoteChar,$=w;if(e.escapeChar!==void 0&&($=e.escapeChar),(typeof t!="string"||-1<o.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");s===!0?s="#":(typeof s!="string"||-1<o.BAD_DELIMITERS.indexOf(s))&&(s=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var h=0,U=!1;this.parse=function(p,v,a){if(typeof p!="string")throw new Error("Input must be a string");var P=p.length,F=t.length,H=r.length,X=s.length,E=O(i),b=[],M=[],y=[],T=h=0;if(!p)return W();if(K||K!==!1&&p.indexOf(w)===-1){for(var j=p.split(r),I=0;I<j.length;I++){if(y=j[I],h+=y.length,I!==j.length-1)h+=r.length;else if(a)return W();if(!s||y.substring(0,X)!==s){if(E){if(b=[],q(y.split(t)),te(),U)return W()}else q(y.split(t));if(g&&g<=I)return b=b.slice(0,g),W(!0)}}return W()}for(var R=p.indexOf(t,h),_=p.indexOf(r,h),N=new RegExp(Y($)+Y(w),"g"),x=p.indexOf(w,h);;)if(p[h]===w)for(x=h,h++;;){if((x=p.indexOf(w,x+1))===-1)return a||M.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:h}),ee();if(x===P-1)return ee(p.substring(h,x).replace(N,w));if(w===$&&p[x+1]===$)x++;else if(w===$||x===0||p[x-1]!==$){R!==-1&&R<x+1&&(R=p.indexOf(t,x+1));var L=ce((_=_!==-1&&_<x+1?p.indexOf(r,x+1):_)===-1?R:Math.min(R,_));if(p.substr(x+1+L,F)===t){y.push(p.substring(h,x).replace(N,w)),p[h=x+1+L+F]!==w&&(x=p.indexOf(w,h)),R=p.indexOf(t,h),_=p.indexOf(r,h);break}if(L=ce(_),p.substring(x+1+L,x+1+L+H)===r){if(y.push(p.substring(h,x).replace(N,w)),ue(x+1+L+H),R=p.indexOf(t,h),x=p.indexOf(w,h),E&&(te(),U))return W();if(g&&b.length>=g)return W(!0);break}M.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:h}),x++}}else if(s&&y.length===0&&p.substring(h,h+X)===s){if(_===-1)return W();h=_+H,_=p.indexOf(r,h),R=p.indexOf(t,h)}else if(R!==-1&&(R<_||_===-1))y.push(p.substring(h,R)),h=R+F,R=p.indexOf(t,h);else{if(_===-1)break;if(y.push(p.substring(h,_)),ue(_+H),E&&(te(),U))return W();if(g&&b.length>=g)return W(!0)}return ee();function q(z){b.push(z),T=h}function ce(z){var Q=0;return Q=z!==-1&&(z=p.substring(x+1,z))&&z.trim()===""?z.length:Q}function ee(z){return a||(z===void 0&&(z=p.substring(h)),y.push(z),h=P,q(y),E&&te()),W()}function ue(z){h=z,q(y),y=[],_=p.indexOf(r,h)}function W(z){if(e.header&&!v&&b.length&&!G){var Q=b[0],ne={},Ee=new Set(Q);let Oe=!1;for(let de=0;de<Q.length;de++){let re=Q[de];if(ne[re=O(e.transformHeader)?e.transformHeader(re,de):re]){let he,Te=ne[re];for(;he=re+"_"+Te,Te++,Ee.has(he););Ee.add(he),Q[de]=he,ne[re]++,Oe=!0,(Z=Z===null?{}:Z)[he]=re}else ne[re]=1,Q[de]=re;Ee.add(re)}Oe&&console.warn("Duplicate headers found and renamed."),G=!0}return{data:b,errors:M,meta:{delimiter:t,linebreak:r,aborted:U,truncated:!!z,cursor:T+(v||0),renamedHeaders:Z}}}function te(){i(W()),b=[],M=[]}},this.abort=function(){U=!0},this.getCharIndex=function(){return h}}function we(e){var t=e.data,r=m[t.workerId],s=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){s=!0,Re(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Se,resume:Se};if(O(r.userStep)){for(var g=0;g<t.results.data.length&&(r.userStep({data:t.results.data[g],errors:t.results.errors,meta:t.results.meta},i),!s);g++);delete t.results}else O(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!s&&Re(t.workerId,t.results)}function Re(e,t){var r=m[e];O(r.userComplete)&&r.userComplete(t),r.terminate(),delete m[e]}function Se(){throw new Error("Not implemented.")}function ve(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ve(e[t]);return r}function se(e,t){return function(){e.apply(t,arguments)}}function O(e){return typeof e=="function"}return o.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(O(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!O(t.transform)&&t.transform,!t.worker||!o.WORKERS_SUPPORTED)return r=null,o.NODE_STREAM_INPUT,typeof e=="string"?(e=(s=>s.charCodeAt(0)!==65279?s:s.slice(1))(e),r=new(t.download?V:S)(t)):e.readable===!0&&O(e.read)&&O(e.on)?r=new B(t):(d.File&&e instanceof File||e instanceof Object)&&(r=new k(t)),r.stream(e);(r=(()=>{var s;return!!o.WORKERS_SUPPORTED&&(s=(()=>{var i=d.URL||d.webkitURL||null,g=C.toString();return o.BLOB_URL||(o.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",g,")();"],{type:"text/javascript"})))})(),(s=new d.Worker(s)).onmessage=we,s.id=A++,m[s.id]=s)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=O(t.step),t.chunk=O(t.chunk),t.complete=O(t.complete),t.error=O(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},o.unparse=function(e,t){var r=!1,s=!0,i=",",g=`\r
`,K='"',Z=K+K,G=!1,w=null,$=!1,h=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||o.BAD_DELIMITERS.filter(function(v){return t.delimiter.indexOf(v)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(G=t.skipEmptyLines),typeof t.newline=="string"&&(g=t.newline),typeof t.quoteChar=="string"&&(K=t.quoteChar),typeof t.header=="boolean"&&(s=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");w=t.columns}t.escapeChar!==void 0&&(Z=t.escapeChar+K),t.escapeFormulae instanceof RegExp?$=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&($=/^[=+\-@\t\r].*$/)}})(),new RegExp(Y(K),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return U(null,e,G);if(typeof e[0]=="object")return U(w||Object.keys(e[0]),e,G)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||w),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),U(e.fields||[],e.data||[],G);throw new Error("Unable to serialize unrecognized input");function U(v,a,P){var F="",H=(typeof v=="string"&&(v=JSON.parse(v)),typeof a=="string"&&(a=JSON.parse(a)),Array.isArray(v)&&0<v.length),X=!Array.isArray(a[0]);if(H&&s){for(var E=0;E<v.length;E++)0<E&&(F+=i),F+=p(v[E],E);0<a.length&&(F+=g)}for(var b=0;b<a.length;b++){var M=(H?v:a[b]).length,y=!1,T=H?Object.keys(a[b]).length===0:a[b].length===0;if(P&&!H&&(y=P==="greedy"?a[b].join("").trim()==="":a[b].length===1&&a[b][0].length===0),P==="greedy"&&H){for(var j=[],I=0;I<M;I++){var R=X?v[I]:I;j.push(a[b][R])}y=j.join("").trim()===""}if(!y){for(var _=0;_<M;_++){0<_&&!T&&(F+=i);var N=H&&X?v[_]:_;F+=p(a[b][N],_)}b<a.length-1&&(!P||0<M&&!T)&&(F+=g)}}return F}function p(v,a){var P,F;return v==null?"":v.constructor===Date?JSON.stringify(v).slice(1,25):(F=!1,$&&typeof v=="string"&&$.test(v)&&(v="'"+v,F=!0),P=v.toString().replace(h,Z),(F=F||r===!0||typeof r=="function"&&r(v,a)||Array.isArray(r)&&r[a]||((H,X)=>{for(var E=0;E<X.length;E++)if(-1<H.indexOf(X[E]))return!0;return!1})(P,o.BAD_DELIMITERS)||-1<P.indexOf(i)||P.charAt(0)===" "||P.charAt(P.length-1)===" ")?K+P+K:P)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!u&&!!d.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=J,o.ParserHandle=ae,o.NetworkStreamer=V,o.FileStreamer=k,o.StringStreamer=S,o.ReadableStreamStreamer=B,d.jQuery&&((f=d.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(g){if(!(f(this).prop("tagName").toUpperCase()==="INPUT"&&f(this).attr("type").toLowerCase()==="file"&&d.FileReader)||!this.files||this.files.length===0)return!0;for(var K=0;K<this.files.length;K++)r.push({file:this.files[K],inputElem:this,instanceConfig:f.extend({},t)})}),s(),this;function s(){if(r.length===0)O(e.complete)&&e.complete();else{var g,K,Z,G,w=r[0];if(O(e.before)){var $=e.before(w.file,w.inputElem);if(typeof $=="object"){if($.action==="abort")return g="AbortError",K=w.file,Z=w.inputElem,G=$.reason,void(O(e.error)&&e.error({name:g},K,Z,G));if($.action==="skip")return void i();typeof $.config=="object"&&(w.instanceConfig=f.extend(w.instanceConfig,$.config))}else if($==="skip")return void i()}var h=w.instanceConfig.complete;w.instanceConfig.complete=function(U){O(h)&&h(U,w.file,w.inputElem),i()},o.parse(w.file,w.instanceConfig)}}function i(){r.splice(0,1),s()}}),l&&(d.onmessage=function(e){e=e.data,o.WORKER_ID===void 0&&e&&(o.WORKER_ID=e.workerId),typeof e.input=="string"?d.postMessage({workerId:o.WORKER_ID,results:o.parse(e.input,e.config),finished:!0}):(d.File&&e.input instanceof File||e.input instanceof Object)&&(e=o.parse(e.input,e.config))&&d.postMessage({workerId:o.WORKER_ID,results:e,finished:!0})}),(V.prototype=Object.create(D.prototype)).constructor=V,(k.prototype=Object.create(D.prototype)).constructor=k,(S.prototype=Object.create(S.prototype)).constructor=S,(B.prototype=Object.create(D.prototype)).constructor=B,o})}(ge)),ge.exports}var Qe=We();const Je=Ue(Qe),ke=[{id:"demo",name:"デモ問題",csvPath:"/fast-learning/data/demo.csv",promptKey:"city",answerKey:"prefecture",choiceCount:4,promptTemplate:n=>`${n.city} はどの県？`,choiceTemplate:n=>n.prefecture},{id:"phone",name:"市外局番 から 都道府県",csvPath:"/fast-learning/data/phone.csv",promptKey:"phoneCode",answerKey:"prefecture",choiceCount:4,promptTemplate:n=>`市外局番 ${n.phoneCode} はどの県？`,choiceTemplate:n=>n.prefecture},{id:"phone-to-region",name:"市外局番 から 地域",csvPath:"/fast-learning/data/phone.csv",promptKey:"phoneCode",answerKey:"region",choiceCount:4,promptTemplate:n=>`${n.phoneCode} の地域は？`,choiceTemplate:n=>`${n.region}（${n.yomigana}）`},{id:"region-to-phone",name:"地域 から 市外局番",csvPath:"/fast-learning/data/phone.csv",promptKey:"region",answerKey:"phoneCode",choiceCount:4,promptTemplate:n=>`${n.region}（${n.yomigana}） の市外局番は？`,choiceTemplate:n=>`${n.phoneCode}`},{id:"region-to-pref",name:"地域 から 都道府県",csvPath:"/fast-learning/data/phone.csv",promptKey:"region",answerKey:"prefecture",choiceCount:4,promptTemplate:n=>`${n.region}（${n.yomigana}） の都道府県は？`,choiceTemplate:n=>n.prefecture},{id:"pref-to-region",name:"都道府県 から 地域",csvPath:"/fast-learning/data/phone.csv",promptKey:"prefecture",answerKey:"region",choiceCount:4,promptTemplate:n=>`${n.prefecture} の地域は？`,choiceTemplate:n=>`${n.region}（${n.yomigana}）`},{id:"prefecture-to-phone",name:"都道府県 から 市外局番",csvPath:"/fast-learning/data/phone.csv",promptKey:"prefecture",answerKey:"phoneCode",choiceCount:4,promptTemplate:n=>`${n.prefecture}の市外局番は？`,choiceTemplate:n=>`${n.phoneCode}`}],ye=n=>[...n].sort(()=>Math.random()-.5),Ae=document.getElementById("nav"),me=document.getElementById("stop-btn"),ie=document.getElementById("app"),be=document.getElementById("progress-btn"),xe=document.getElementById("theme-toggle-btn"),De=()=>{ie.innerHTML="";const n=document.createElement("div");n.className="main-menu",ke.forEach(c=>{const C=document.createElement("button");C.textContent=c.name,C.onclick=()=>Pe(c.id),n.appendChild(C)}),ie.appendChild(n)};De();let _e=[],$e=0,pe=!1,fe=Be();async function Ye(){pe=!1,ie.innerHTML="",me.hidden=!1;const n=document.createElement("select");ke.forEach(o=>{const D=document.createElement("option");D.value=o.id,D.textContent=o.name,n.appendChild(D)});const c=document.createElement("label");c.textContent="問題セット: ",c.appendChild(n),ie.appendChild(c);let C=await Ce(n.value);n.onchange=async()=>{C=await Ce(n.value),m()};const d=document.createElement("table");d.className="stat-table",d.innerHTML=`
    <thead><tr>
      <th>問題</th><th>正答</th><th>正答数</th><th>出題数</th><th>正答率</th>
    </tr></thead>
    <tbody></tbody>`;const f=d.tBodies[0];let u="rate",l=-1;const m=()=>{f.innerHTML="";const o=Me();C.map(k=>({card:k,stat:o[k.id]??{asked:0,correct:0}})).sort((k,S)=>{let B=0;if(u==="prompt")B=(k.card.prompt.type==="text"?k.card.prompt.text:"").localeCompare(S.card.prompt.type==="text"?S.card.prompt.text:"");else if(u==="answer"){const ae=(k.card.choices.find(J=>J.id===k.card.answer)??{type:"text"}).type==="text"?k.card.choices.find(J=>J.id===k.card.answer).text:"",Y=(S.card.choices.find(J=>J.id===S.card.answer)??{type:"text"}).type==="text"?S.card.choices.find(J=>J.id===S.card.answer).text:"";B=ae.localeCompare(Y)}else u==="correct"?B=k.stat.correct-S.stat.correct:u==="asked"?B=k.stat.asked-S.stat.asked:B=(k.stat.asked?k.stat.correct/k.stat.asked:0)-(S.stat.asked?S.stat.correct/S.stat.asked:0);return B*l}).forEach(({card:k,stat:S})=>{const B=S.asked?(S.correct/S.asked*100).toFixed(0):"0",ae=document.createElement("tr"),Y=k.choices.find(we=>we.id===k.answer),J=(Y==null?void 0:Y.type)==="text"?Y.text:"[画像]";ae.innerHTML=`
        <td>${k.prompt.type==="text"?k.prompt.text.slice(0,20):"[画像]"}</td>
        <td>${J.slice(0,20)}</td>
        <td>${S.correct}</td>
        <td>${S.asked}</td>
        <td>${B}%</td>`,f.appendChild(ae)})},A=d.tHead.rows[0].cells;["prompt","answer","correct","asked","rate"].forEach((o,D)=>{A[D].style.cursor="pointer",A[D].onclick=()=>{u===o?l=l===1?-1:1:(u=o,l=-1),["問題","正答","正答数","出題数","正答率"].forEach((V,k)=>A[k].textContent=V),A[D].textContent+=l===-1?" ▼":" ▲",m()}}),A[4].textContent+=" ▼",ie.appendChild(d),m()}be.onclick=Ye;const Me=()=>{const n={};return fe.forEach(c=>{var d;const C=n[d=c.cardId]??(n[d]={asked:0,correct:0});C.asked+=1,c.correct&&(C.correct+=1)}),n},Ce=async n=>{const c=ke.find(m=>m.id===n);if(!c)throw new Error(`Unknown quiz config: ${n}`);const C=await(await fetch(c.csvPath)).text(),{data:d}=Je.parse(C,{header:!0}),f=d.filter(m=>Object.values(m).some(A=>A)),u=new Map;f.forEach(m=>{const A=`${m[c.promptKey]}|${m[c.answerKey]}`;u.has(A)||u.set(A,m)});const l=Array.from(u.values());return ye(l.map(m=>{const A=m[c.answerKey],o=m[c.promptKey],D=ye(l.filter(k=>k[c.promptKey]!==m[c.promptKey]&&k[c.answerKey]!==A).map(k=>k[c.answerKey])).filter((k,S,B)=>B.indexOf(k)===S).slice(0,c.choiceCount-1),V=ye([A,...D]).map(k=>{const S=l.find(B=>B[c.answerKey]===k);return{id:k,type:"text",text:c.choiceTemplate(S)}});return{id:`${n}:${o}:${A}`,prompt:{type:"text",text:c.promptTemplate(m)},choices:V,answer:A,tags:[n]}}))},Fe=3,Ze=()=>{const n=_e.length,c=_e.filter(d=>{const u=fe.filter(l=>l.cardId===d.id).slice(-3);return u.length<Fe||u.some(l=>!l.correct)}).length,C=document.getElementById("question-count");C&&(C.textContent=`残り ${c} 問 / 全 ${n} 問`)},Ke=()=>{if(!pe)return;Ze();const n=Me(),c=_e.filter(f=>{const l=fe.filter(m=>m.cardId===f.id).slice(-3);return l.length<Fe||l.some(m=>!m.correct)});if(c.length===0){ie.innerHTML="<h1>コンプリートです！</h1>",me.hidden=!1;return}const C=ye(c).sort((f,u)=>{const l=n[f.id]||{asked:0,correct:0},m=n[u.id]||{asked:0,correct:0};if(l.asked===0&&m.asked>0)return-1;if(l.asked>0&&m.asked===0)return 1;const A=l.asked>0?(l.asked-l.correct)/l.asked:1,o=m.asked>0?(m.asked-m.correct)/m.asked:1;if(A!==o)return o-A;const D=l.asked>0?l.correct/l.asked:0,V=m.asked>0?m.correct/m.asked:0;return D-V}),d=C[$e++%C.length];ze(d,n[d.id],(f,u)=>{fe.push({ts:Date.now(),cardId:d.id,choiceId:u,correct:f}),He(fe);const l=document.querySelector(`.choice[data-id="${u}"]`),m=document.querySelector(`.choice[data-id="${d.answer}"]`);f?l==null||l.classList.add("highlight-correct"):(l==null||l.classList.add("highlight-incorrect"),m==null||m.classList.add("highlight-correct")),document.querySelectorAll(".choice").forEach(A=>{A.onclick=()=>{Ke()}})})},Pe=async n=>{pe=!1,ie.innerHTML="";const c=document.createElement("div");c.id="question-count",c.style.marginBottom="1rem",ie.appendChild(c),_e=await Ce(n),$e=0,me.hidden=!1,be.hidden=!0,pe=!0,Ke()},Ge=()=>{pe=!1,ie.innerHTML="",me.hidden=!0,Ae.hidden=!1,be.hidden=!1;const n=document.getElementById("question-count");n&&(n.textContent=""),De()};Ae.querySelectorAll("button").forEach(n=>{const c=ke.find(C=>C.id===n.dataset.set);c&&(n.textContent=c.name,n.onclick=()=>Pe(c.id))});me.onclick=Ge;const Xe=localStorage.getItem("theme");Xe==="dark"&&(document.body.classList.add("dark-mode"),xe.textContent="ライトモード");const Ve=()=>{const n=document.body.classList.toggle("dark-mode");xe.textContent=n?"ライトモード":"ダークモード",localStorage.setItem("theme",n?"dark":"light")};xe.onclick=Ve;
